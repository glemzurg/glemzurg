{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "query.schema.json",
  "title": "Query",
  "description": "Schema for query JSON files that define queries for classes. Query files are located alongside their class file with '.queries.json' extension (e.g., 'order_management/order.queries.json' for class 'order_management/order.class.json'). Queries represent read-only operations that return information without modifying state. The file contains a map of query keys to query definitions. If validation fails, verify 'name' is present and non-empty for each query.",
  "type": "object",
  "properties": {
    "name": {
      "type": "string",
      "description": "The display name of the query (e.g., 'Get Order Total', 'Find Pending Orders', 'Calculate Shipping Cost'). This is the human-readable name shown in documentation. Use verb phrases that describe what information the query returns. Must be non-empty. If validation fails: ensure this is a string with at least one character.",
      "minLength": 1
    },
    "details": {
      "type": "string",
      "description": "Optional detailed description of the query. Describe what information the query returns, any parameters it requires, and performance considerations. This helps implementers understand the query's purpose and expected behavior."
    },
    "parameters": {
      "type": "array",
      "description": "Parameters for the query. Each parameter has a name and optional data type rules.",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "The name of the parameter.",
            "minLength": 1
          },
          "data_type_rules": {
            "type": "string",
            "description": "Data type rules for the parameter value."
          }
        },
        "required": ["name"],
        "additionalProperties": false
      }
    },
    "requires": {
      "type": "array",
      "description": "Preconditions that must be true before the query can execute. Each item is a logic specification with a description and optional formal notation.",
      "items": {
        "type": "object",
        "properties": {
          "description": {
            "type": "string",
            "description": "A precondition statement. Describe what must be true for this query to execute correctly.",
            "minLength": 1
          },
          "notation": {
            "type": "string",
            "description": "Optional formal notation system (e.g., 'tla_plus')."
          },
          "specification": {
            "type": "string",
            "description": "Optional formal specification in the given notation."
          }
        },
        "required": ["description"],
        "additionalProperties": false
      }
    },
    "guarantees": {
      "type": "array",
      "description": "Postconditions describing what the query returns. Each item is a logic specification with a description and optional formal notation.",
      "items": {
        "type": "object",
        "properties": {
          "description": {
            "type": "string",
            "description": "A postcondition statement describing the query result.",
            "minLength": 1
          },
          "notation": {
            "type": "string",
            "description": "Optional formal notation system (e.g., 'tla_plus')."
          },
          "specification": {
            "type": "string",
            "description": "Optional formal specification in the given notation."
          }
        },
        "required": ["description"],
        "additionalProperties": false
      }
    }
  },
  "required": ["name"],
  "additionalProperties": false
}
