{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "action.schema.json",
  "title": "Action",
  "description": "Schema for action JSON files that define actions for classes. Action files are located alongside their class file with '.actions.json' extension (e.g., 'order_management/order.actions.json' for class 'order_management/order.class.json'). Actions represent operations that modify state and are referenced by state machines. The file contains a map of action keys to action definitions. If validation fails, verify 'name' is present and non-empty for each action.",
  "type": "object",
  "properties": {
    "name": {
      "type": "string",
      "description": "The display name of the action (e.g., 'Send Confirmation Email', 'Reserve Inventory', 'Calculate Total'). This is the human-readable name shown in state diagrams and documentation. Use verb phrases that describe what the action does. Must be non-empty. If validation fails: ensure this is a string with at least one character.",
      "minLength": 1
    },
    "details": {
      "type": "string",
      "description": "Optional detailed description of the action. Describe what the action does, what side effects it has, and any important implementation considerations. This helps implementers understand the full scope of the action."
    },
    "parameters": {
      "type": "array",
      "description": "Parameters for the action. Each parameter has a name and optional data type rules.",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "The name of the parameter.",
            "minLength": 1
          },
          "data_type_rules": {
            "type": "string",
            "description": "Data type rules for the parameter value."
          }
        },
        "required": ["name"],
        "additionalProperties": false
      }
    },
    "requires": {
      "type": "array",
      "description": "Preconditions that must be true before the action can execute. Each item is a logic specification with a description and optional formal notation.",
      "items": {
        "type": "object",
        "properties": {
          "description": {
            "type": "string",
            "description": "A precondition statement. Describe what must be true for this action to execute correctly.",
            "minLength": 1
          },
          "notation": {
            "type": "string",
            "description": "Optional formal notation system. Currently the only supported value is 'tla_plus' (TLA+ notation). If validation fails: ensure this is exactly 'tla_plus'.",
            "enum": ["tla_plus"]
          },
          "specification": {
            "type": "string",
            "description": "Optional formal specification in the given notation."
          }
        },
        "required": ["description"],
        "additionalProperties": false
      }
    },
    "guarantees": {
      "type": "array",
      "description": "Postconditions that will be true after the action executes successfully. Each item is a logic specification with a description and optional formal notation.",
      "items": {
        "type": "object",
        "properties": {
          "description": {
            "type": "string",
            "description": "A postcondition statement. Describe what will be true after the action completes.",
            "minLength": 1
          },
          "notation": {
            "type": "string",
            "description": "Optional formal notation system. Currently the only supported value is 'tla_plus' (TLA+ notation). If validation fails: ensure this is exactly 'tla_plus'.",
            "enum": ["tla_plus"]
          },
          "specification": {
            "type": "string",
            "description": "Optional formal specification in the given notation."
          }
        },
        "required": ["description"],
        "additionalProperties": false
      }
    },
    "safety_rules": {
      "type": "array",
      "description": "Safety rules that must always hold during and after the action. Each item is a logic specification.",
      "items": {
        "type": "object",
        "properties": {
          "description": {
            "type": "string",
            "description": "A safety rule statement.",
            "minLength": 1
          },
          "notation": {
            "type": "string",
            "description": "Optional formal notation system. Currently the only supported value is 'tla_plus' (TLA+ notation). If validation fails: ensure this is exactly 'tla_plus'.",
            "enum": ["tla_plus"]
          },
          "specification": {
            "type": "string",
            "description": "Optional formal specification in the given notation."
          }
        },
        "required": ["description"],
        "additionalProperties": false
      }
    }
  },
  "required": ["name"],
  "additionalProperties": false
}
